{% extends 'app/seller/seller-base.html' %}
{% load static %}

{% block title %}Analytics{% endblock %}

{% block extra_css %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  .analytics-card {
    height: 280px; /* keeps cards uniform */
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }
  .chart-container {
    position: relative;
    height: 200px; /* fix height */
    width: 100%;
  }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid px-4" style="margin-top: 110px;">

  <!-- Page Title -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="fw-bold">Seller Analytics Dashboard</h2>
    <span class="text-muted">Performance overview of your listings</span>
  </div>

  <!-- Stats Overview -->
  <div class="row g-4 mb-4">
    <div class="col-md-3 col-6">
      <div class="card shadow-sm border-0 text-center p-3">
        <h6 class="fw-semibold text-muted">Total Properties</h6>
        <h2 class="text-primary fw-bold">12</h2>
        <small class="text-success">+2 this month</small>
      </div>
    </div>
    <div class="col-md-3 col-6">
      <div class="card shadow-sm border-0 text-center p-3">
        <h6 class="fw-semibold text-muted">Enquiries</h6>
        <h2 class="text-success fw-bold">48</h2>
        <small class="text-success">+15% growth</small>
      </div>
    </div>
    <div class="col-md-3 col-6">
      <div class="card shadow-sm border-0 text-center p-3">
        <h6 class="fw-semibold text-muted">Visits</h6>
        <h2 class="text-warning fw-bold">3.2k</h2>
        <small class="text-danger">-5% this week</small>
      </div>
    </div>
    <div class="col-md-3 col-6">
      <div class="card shadow-sm border-0 text-center p-3">
        <h6 class="fw-semibold text-muted">Conversions</h6>
        <h2 class="text-danger fw-bold">18</h2>
        <small class="text-success">+3 closed deals</small>
      </div>
    </div>
  </div>

  <!-- Charts Row -->
  <div class="row g-4">
    <div class="col-lg-6">
      <div class="card shadow-sm border-0 analytics-card">
        <div class="card-body">
          <h6 class="card-title fw-semibold">Enquiries Trend</h6>
          <div class="chart-container">
            <canvas id="enquiriesChart"></canvas>
          </div>
        </div>
      </div>
    </div>

    <div class="col-lg-6">
      <div class="card shadow-sm border-0 analytics-card">
        <div class="card-body">
          <h6 class="card-title fw-semibold">Property Distribution</h6>
          <div class="chart-container">
            <canvas id="propertyChart"></canvas>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Visitors -->
  <div class="row g-4 mt-1">
    <div class="col-12">
      <div class="card shadow-sm border-0 analytics-card">
        <div class="card-body">
          <h6 class="card-title fw-semibold">Visitor Insights</h6>
          <div class="chart-container">
            <canvas id="visitorsChart"></canvas>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>

<!-- Charts Script -->
<script>
  // Enquiries Trend
  new Chart(document.getElementById('enquiriesChart'), {
    type: 'line',
    data: {
      labels: ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug'],
      datasets: [{
        label: 'Enquiries',
        data: [12, 19, 8, 25, 30, 22, 40, 48],
        borderColor: '#0d6efd',
        backgroundColor: 'rgba(13, 110, 253, 0.2)',
        borderWidth: 2,
        fill: true,
        tension: 0.3
      }]
    },
    options: { 
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display: false } }
    }
  });

  // Property Distribution
  new Chart(document.getElementById('propertyChart'), {
    type: 'doughnut',
    data: {
      labels: ['Apartments', 'Villas', 'Offices', 'Plots'],
      datasets: [{
        data: [5, 3, 2, 2],
        backgroundColor: ['#0d6efd','#198754','#ffc107','#dc3545']
      }]
    },
    options: { 
      responsive: true, 
      maintainAspectRatio: false,
      plugins: { legend: { position: 'bottom' } }
    }
  });

  // Visitors Insights
  new Chart(document.getElementById('visitorsChart'), {
    type: 'bar',
    data: {
      labels: ['Week 1','Week 2','Week 3','Week 4'],
      datasets: [{
        label: 'Visitors',
        data: [800, 1200, 950, 1300],
        backgroundColor: '#20c997'
      }]
    },
    options: { 
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display: false } },
      scales: { y: { beginAtZero: true } }
    }
  });
</script>
{% endblock %}
